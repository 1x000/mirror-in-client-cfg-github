{% extends 'base.html' %}

{% block title %}{{ partition.name }} - 纪狗资源镜像保存站{% endblock %}

{% block content %}
<div class="row">
    <!-- 主内容区 -->
    <div class="col-lg-12">

        <h2 class="mb-4 border-bottom pb-2">{{ partition.name }}</h2>

        {# 检查是否有任何文件夹 #}
        {% if all_folders %}
            {# 遍历分组 #}
            {% for group in groups %}
                <h4 class="mb-3 mt-4"><i class="fas fa-layer-group me-2"></i>{{ group.name or '未分类' }}</h4>
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
                {% set group_folders = all_folders|selectattr('group_id', 'equalto', group.id) | list %}
                {% for folder in group_folders %}
                    <!-- 单个文件夹卡片 -->
                    <div class="col">
                        <a href="{{ url_for('folder_detail', folder_id=folder.id) }}" class="text-decoration-none">
                            <div class="card h-100 text-center shadow-sm" style="transition: transform 0.2s; cursor: pointer;" onmouseover="this.style.transform='translateY(-5px)';" onmouseout="this.style.transform='translateY(0)';">
                                <div style="height: 120px; display: flex; align-items: center; justify-content: center; background-color: #f8f9fa;">
                                    {% if folder.logo_filename %}
                                    <img src="{{ url_for('static', filename='logos/' + folder.logo_filename) }}" style="max-height: 80px; max-width: 100%; object-fit: contain;" alt="{{ folder.name }} logo">
                                    {% else %}
                                    <i class="fas fa-cube fa-3x text-muted"></i>
                                    {% endif %}
                                </div>
                                <div class="card-body py-2">
                                    <h6 class="card-title mb-1 text-dark text-truncate" title="{{ folder.name }}">{{ folder.name }}</h6>
                                </div>
                                <div class="card-footer bg-transparent border-0 pt-0 pb-2">
                                    <small class="text-muted text-truncate d-block" title="{{ folder.description }}">{{ folder.description or ' ' }}</small>
                                </div>
                            </div>
                        </a>
                    </div>
                {% endfor %}
                </div>
                {% if not group_folders %}
                    <p class="text-muted">此分组下暂无文件夹。</p>
                {% endif %}
            {% endfor %}
        {% else %}
            <!-- 如果没有任何文件夹 -->
            <div class="col-12">
                <p class="text-center text-muted py-5">此分区下暂无任何内容。</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
